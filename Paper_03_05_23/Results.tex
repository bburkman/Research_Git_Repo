%%%%%
%\section{Results}

We tested several combinations of model inputs.  

\begin{itemize}
	\item Baseline, Medium, and Hard to collect features
	\item Undersampling with Tomek links
	\item Model types
	\item Loss Functions
	\item Class weights parameters and other hyperparameters
\end{itemize}

We do not hope to get a perfect model, but something better than, ``Never send an ambulance,'' ``Always send an ambulance,'' or random noise.

\


\begin{tabular}{@{}lllcp{1.8in}}
	Loss Function & Abbreviation & Source & Class Weights  & Notes \cr\hline
	AdaBoost & AdaBoost & Sklearn & No \cr
	Balanced Bagging & BalBag & Imblearn & No \cr
	Balanced Random Forest & BRForest & Imblearn & Yes \cr
	Binary Focal Crossentropy & Focal & Keras & Yes & $\gamma = 0.0$, $0.5$, $1.0$, and  $2.0$ \cr
	Easy Ensemble Classifier & EasyEns & Imblearn & No & Uses Adaboost as its estimator \cr
	Logistic Regression & LogReg & Sklearn & Yes \cr
	Random Undersampled Boost & RUSBoost & Imblearn & No \cr
\end{tabular}

\

Using $\gamma=0.0$ in binary focal crossentropy makes it the same as binary crossentropy.

\

\begin{tabular}{*4l >{\bf}l ll}
Model & Features & Precision & Recall & F1 & $p$ & AUC \cr\hline
BRForest & Hard & 0.506 & 0.373 & 0.429 & 0.693 & 0.797 \cr
Focal $\gamma=2.0$ & Hard & 0.475 & 0.314 & 0.378 & 0.701 & 0.775 \cr
Focal $\gamma=0.5$ & Hard & 0.483 & 0.301 & 0.371 & 0.674 & 0.773 \cr
Focal $\gamma=0.0$ & Hard & 0.482 & 0.301 & 0.371 & 0.653 & 0.775 \cr
Focal $\gamma=1.0$ & Hard & 0.483 & 0.294 & 0.366 & 0.615 & 0.774 \cr
BalBag & Hard & 0.499 & 0.278 & 0.357 & 0.72 & 0.759 \cr
LogReg & Hard & 0.435 & 0.265 & 0.329 & 0.5 & 0.753 \cr
AdaBoost & Hard & 0.435 & 0.257 & 0.323 & 0.498 & 0.752 \cr
RUSBoost & Hard & 0.435 & 0.256 & 0.322 & 0.5 & 0.752 \cr
EasyEns & Hard & 0.423 & 0.206 & 0.277 & 0.527 & 0.731 \cr\hline
BRForest & Medium & 0.431 & 0.217 & 0.289 & 0.773 & 0.726 \cr
Focal $\gamma=0.0$ & Medium & 0.436 & 0.191 & 0.265 & 0.687 & 0.713 \cr
Focal $\gamma=2.0$ & Medium & 0.439 & 0.182 & 0.258 & 0.574 & 0.713 \cr
Focal $\gamma=0.5$ & Medium & 0.436 & 0.181 & 0.256 & 0.634 & 0.714 \cr
Focal $\gamma=1.0$ & Medium & 0.441 & 0.178 & 0.254 & 0.608 & 0.713 \cr
LogReg & Medium & 0.421 & 0.172 & 0.245 & 0.496 & 0.703 \cr
AdaBoost & Medium & 0.425 & 0.166 & 0.239 & 0.498 & 0.703 \cr
RUSBoost & Medium & 0.43 & 0.158 & 0.231 & 0.5 & 0.703 \cr
EasyEns & Medium & 0.413 & 0.153 & 0.224 & 0.527 & 0.69 \cr
BalBag & Medium & 0.428 & 0.132 & 0.202 & 0.81 & 0.691 \cr\hline
BRForest & Baseline & 0.407 & 0.051 & 0.091 & 0.914 & 0.659 \cr
BalBag & Baseline & 0.383 & 0.05 & 0.088 & 0.88 & 0.654 \cr
Focal $\gamma=0.0$ & Baseline & 0.363 & 0.041 & 0.073 & 0.692 & 0.662 \cr
Focal $\gamma=1.0$ & Baseline & 0.355 & 0.03 & 0.056 & 0.609 & 0.662 \cr
Focal $\gamma=0.5$ & Baseline & 0.357 & 0.029 & 0.053 & 0.645 & 0.66 \cr
Focal $\gamma=2.0$ & Baseline & 0.351 & 0.023 & 0.044 & 0.575 & 0.659 \cr
EasyEns & Baseline & 0.354 & 0.012 & 0.023 & 0.531 & 0.654 \cr
LogReg & Baseline & 0.356 & 0.01 & 0.019 & 0.561 & 0.657 \cr
RUSBoost & Baseline & 0.354 & 0.009 & 0.017 & 0.5 & 0.657 \cr
AdaBoost & Baseline & 0.356 & 0.007 & 0.014 & 0.499 & 0.657 \cr
\end{tabular}


\

\noindent\begin{tabular}{@{}p{0.3\textwidth}@{\hspace{24pt}} p{0.3\textwidth} @{\hspace{24pt}} p{0.3\textwidth}}
  \vspace{0pt} \input{../Keras/Images/BRFC_Hard_Tomek_0_r_target_Pred.pgf}
  &
  \vspace{0pt} \input{../Keras/Images/BRFC_Hard_Tomek_0_r_target_FP_TP.pgf}
  &
\vspace{0pt} 
  
\begin{tabular}{cc|c|c|}
	&\multicolumn{1}{c}{}& \multicolumn{2}{c}{Prediction} \cr
	&\multicolumn{1}{c}{} & \multicolumn{1}{c}{N} & \multicolumn{1}{c}{P} \cr\cline{3-4}
	\multirow{2}{*}{\rotatebox[origin=c]{90}{Actual}}&N & 
	112228 & 38543	
	\vrule width 0pt height 10pt depth 2pt \cr\cline{3-4}
	&P & 
	7960 & 18661
	\vrule width 0pt height 10pt depth 2pt \cr\cline{3-4}
\end{tabular}

\begin{center}
\begin{tabular}{ll}
0.326 & Precision \cr 	0.701 & Recall \cr 	0.445 & F1 \cr 
\end{tabular}
\end{center}
  
\end{tabular}

\

\noindent\begin{tabular}{@{}p{0.3\textwidth}@{\hspace{24pt}} p{0.3\textwidth} @{\hspace{24pt}} p{0.3\textwidth}}
  \vspace{0pt} \input{../Keras/Images/BRFC_Hard_Tomek_0_r_target_Linear_Transform_Pred.pgf}
  &
  \vspace{0pt} \input{../Keras/Images/BRFC_Hard_Tomek_0_r_target_Linear_Transform_ROC.pgf}
  &
\vspace{0pt} 
  
\begin{tabular}{cc|c|c|}
	&\multicolumn{1}{c}{}& \multicolumn{2}{c}{Prediction} \cr
	&\multicolumn{1}{c}{} & \multicolumn{1}{c}{N} & \multicolumn{1}{c}{P} \cr\cline{3-4}
	\multirow{2}{*}{\rotatebox[origin=c]{90}{Actual}}&N & 
	141062 & 9709
	\vrule width 0pt height 10pt depth 2pt \cr\cline{3-4}
	&P & 
	16696 & 9925
	\vrule width 0pt height 10pt depth 2pt \cr\cline{3-4}
\end{tabular}

\begin{center}
\begin{tabular}{ll}
0.506 & Precision \cr 	0.373 & Recall \cr 	0.429 & F1 \cr \end{tabular}
\end{center}
  
\end{tabular}









